/*
JSZip - A Javascript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2012 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See LICENSE.markdown.
*/

var JSZip=function(t,r){this.files={},this.root="",t&&this.load(t,r)}
JSZip.signature={LOCAL_FILE_HEADER:"PK",CENTRAL_FILE_HEADER:"PK",CENTRAL_DIRECTORY_END:"PK",ZIP64_CENTRAL_DIRECTORY_LOCATOR:"PK",ZIP64_CENTRAL_DIRECTORY_END:"PK",DATA_DESCRIPTOR:"PK\b"},JSZip.defaults={base64:!1,binary:!1,dir:!1,date:null},JSZip.prototype=function(){var t=function(t,r,e){this.name=t,this.data=r,this.options=e}
t.prototype={asText:function(){return this.options.binary?JSZip.prototype.utf8decode(this.data):this.data},asBinary:function(){return this.options.binary?this.data:JSZip.prototype.utf8encode(this.data)}}
var r=function(t,r){var e,n=""
for(e=0;r>e;e++)n+=String.fromCharCode(255&t),t>>>=8
return n},e=function(){var t,r,e={}
for(t=0;arguments.length>t;t++)for(r in arguments[t])e[r]===void 0&&(e[r]=arguments[t][r])
return e},n=function(t){return t=t||{},t.base64===!0&&null==t.binary&&(t.binary=!0),t=e(t,JSZip.defaults),t.date=t.date||new Date,t},i=function(r,e,i){var s=o(r)
return s&&a.call(this,s),i=n(i),this.files[r]=new t(r,e,i)},o=function(t){"/"==t.slice(-1)&&(t=t.substring(0,t.length-1))
var r=t.lastIndexOf("/")
return r>0?t.substring(0,r):""},a=function(t){if("/"!=t.slice(-1)&&(t+="/"),!this.files[t]){var r=o(t)
r&&a.call(this,r),i.call(this,t,"",{dir:!0})}return this.files[t]},s=function(t,e,n){var i,o,a=e!==t.name,s=t.data,h=t.options
i=h.date.getHours(),i<<=6,i|=h.date.getMinutes(),i<<=5,i|=h.date.getSeconds()/2,o=h.date.getFullYear()-1980,o<<=4,o|=h.date.getMonth()+1,o<<=5,o|=h.date.getDate(),h.base64===!0&&(s=JSZipBase64.decode(s)),h.binary===!1&&(s=this.utf8encode(s))
var f=JSZip.compressions[n],c=f.compress(s),u=""
return u+="\n\0",u+=a?"\0\b":"\0\0",u+=f.magic,u+=r(i,2),u+=r(o,2),u+=r(this.crc32(s),4),u+=r(c.length,4),u+=r(s.length,4),u+=r(e.length,2),u+="\0\0",{header:u,compressedData:c}}
return{load:function(){throw Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(r){var n,i,o,a,s=[]
for(n in this.files)o=this.files[n],a=new t(o.name,o.data,e(o.options)),i=n.slice(this.root.length,n.length),n.slice(0,this.root.length)===this.root&&r(i,a)&&s.push(a)
return s},file:function(t,r,e){if(1===arguments.length){if(t instanceof RegExp){var n=t
return this.filter(function(t,r){return!r.options.dir&&n.test(t)})}return this.filter(function(r,e){return!e.options.dir&&r===t})[0]||null}return t=this.root+t,i.call(this,t,r,e),this},folder:function(t){if(!t)throw Error("folder : wrong argument")
if(t instanceof RegExp)return this.filter(function(r,e){return e.options.dir&&t.test(r)})
var r=this.root+t,e=a.call(this,r),n=this.clone()
return n.root=e.name,n},remove:function(t){t=this.root+t
var r=this.files[t]
if(r||("/"!=t.slice(-1)&&(t+="/"),r=this.files[t]),r)if(r.options.dir)for(var e=this.filter(function(r,e){return e.name.slice(0,t.length)===t}),n=0;e.length>n;n++)delete this.files[e[n].name]
else delete this.files[t]
return this},generate:function(t){t=e(t||{},{base64:!0,compression:"STORE"})
var n=t.compression.toUpperCase(),i=[],o=[],a=0
if(!JSZip.compressions[n])throw n+" is not a valid compression method !"
for(var h in this.files)if(this.files.hasOwnProperty(h)){var f=this.files[h],c=this.utf8encode(f.name),u="",d="",l=s.call(this,f,c,n)
u=JSZip.signature.LOCAL_FILE_HEADER+l.header+c+l.compressedData,d=JSZip.signature.CENTRAL_FILE_HEADER+"\0"+l.header+"\0\0"+"\0\0"+"\0\0"+(this.files[h].dir===!0?"\0\0\0":"\0\0\0\0")+r(a,4)+c,a+=u.length,o.push(u),i.push(d)}var g=o.join(""),p=i.join(""),C=""
C=JSZip.signature.CENTRAL_DIRECTORY_END+"\0\0"+"\0\0"+r(o.length,2)+r(o.length,2)+r(p.length,4)+r(g.length,4)+"\0\0"
var m=g+p+C
return t.base64?JSZipBase64.encode(m):m},crc32:function(t,r){if(""===t||t===void 0)return 0
var e=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]
r===void 0&&(r=0)
var n=0,i=0
r=-1^r
for(var o=0,a=t.length;a>o;o++)i=255&(r^t.charCodeAt(o)),n=e[i],r=r>>>8^n
return-1^r},clone:function(){var t=new JSZip
for(var r in this)"function"!=typeof this[r]&&(t[r]=this[r])
return t},utf8encode:function(t){t=t.replace(/\r\n/g,"\n")
for(var r="",e=0;t.length>e;e++){var n=t.charCodeAt(e)
128>n?r+=String.fromCharCode(n):n>127&&2048>n?(r+=String.fromCharCode(192|n>>6),r+=String.fromCharCode(128|63&n)):(r+=String.fromCharCode(224|n>>12),r+=String.fromCharCode(128|63&n>>6),r+=String.fromCharCode(128|63&n))}return r},utf8decode:function(t){for(var r="",e=0,n=0,i=0,o=0;t.length>e;)n=t.charCodeAt(e),128>n?(r+=String.fromCharCode(n),e++):n>191&&224>n?(i=t.charCodeAt(e+1),r+=String.fromCharCode((31&n)<<6|63&i),e+=2):(i=t.charCodeAt(e+1),o=t.charCodeAt(e+2),r+=String.fromCharCode((15&n)<<12|(63&i)<<6|63&o),e+=3)
return r}}}(),JSZip.compressions={STORE:{magic:"\0\0",compress:function(t){return t},uncompress:function(t){return t}}}
var JSZipBase64=function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="
return{encode:function(r){for(var e,n,i,o,a,s,h,f="",c=0;r.length>c;)e=r.charCodeAt(c++),n=r.charCodeAt(c++),i=r.charCodeAt(c++),o=e>>2,a=(3&e)<<4|n>>4,s=(15&n)<<2|i>>6,h=63&i,isNaN(n)?s=h=64:isNaN(i)&&(h=64),f=f+t.charAt(o)+t.charAt(a)+t.charAt(s)+t.charAt(h)
return f},decode:function(r){var e,n,i,o,a,s,h,f="",c=0
for(r=r.replace(/[^A-Za-z0-9\+\/\=]/g,"");r.length>c;)o=t.indexOf(r.charAt(c++)),a=t.indexOf(r.charAt(c++)),s=t.indexOf(r.charAt(c++)),h=t.indexOf(r.charAt(c++)),e=o<<2|a>>4,n=(15&a)<<4|s>>2,i=(3&s)<<6|h,f+=String.fromCharCode(e),64!=s&&(f+=String.fromCharCode(n)),64!=h&&(f+=String.fromCharCode(i))
return f}}}();

/*
JSZip - A Javascript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2011 David Duponchel <d.duponchel@gmail.com>
Dual licenced under the MIT license or GPLv3. See LICENSE.markdown.
*/

(function(){function e(e){this.stream=e,this.index=0}function t(e,t){this.options=e,this.loadOptions=t}function i(e,t){this.files=[],this.loadOptions=t,e&&this.load(e)}var r=function(e){var t,i,r=""
for(i=0;e.length>i;i++)t=e.charCodeAt(i),r+="\\x"+(10>t?"0":"")+t.toString(16)
return r},s=function(e){for(var t in JSZip.compressions)if(JSZip.compressions[t].magic===e)return JSZip.compressions[t]
return null}
e.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(e>this.stream.length||0>e)throw Error("End of stream reached (stream length = "+this.stream.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},eof:function(){return this.index>=this.stream.length},byteAt:function(e){return 255&this.stream.charCodeAt(e)},readByte:function(){return this.checkOffset(1),this.byteAt(1+this.index++)},readInt:function(e){var t,i=0
for(this.checkOffset(e),t=e-1;t>=0;t--)i=(i<<8)+this.byteAt(this.index+t)
return this.index+=e,i},readString:function(e){var t,i,r=""
for(this.checkOffset(e),t=0;e>t;t++)i=this.byteAt(this.index+t),r+=String.fromCharCode(i)
return this.index+=e,r},readDate:function(){var e=this.readInt(4)
return new Date((127&e>>25)+1980,(15&e>>21)-1,31&e>>16,31&e>>11,63&e>>5,(31&e)<<1)}},t.prototype={isEncrypted:function(){return 1===(1&this.bitFlag)},hasDataDescriptor:function(){return 8===(8&this.bitFlag)},useUTF8:function(){return 2048===(2048&this.bitFlag)},isZIP64:function(){return this.options.zip64},readLocalPartHeader:function(e){if(this.versionNeeded=e.readInt(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4),this.fileNameLength=e.readInt(2),this.extraFieldsLength=e.readInt(2),this.isEncrypted())throw Error("Encrypted zip are not supported")},readLocalPart:function(e){var t
if(this.readLocalPartHeader(e),this.fileName=e.readString(this.fileNameLength),this.readExtraFields(e),this.hasDataDescriptor()){if(this.compressedFileData=this.findDataUntilDataDescriptor(e),this.crc32=e.readInt(4),this.compressedSize=e.readInt(this.isZIP64()?8:4),this.uncompressedSize=e.readInt(this.isZIP64()?8:4),this.compressedFileData.length!==this.compressedSize)throw Error("Bug : data descriptor incorrectly read (size mismatch)")}else this.compressedFileData=e.readString(this.compressedSize)
if(this.uncompressedFileData=null,t=s(this.compressionMethod),null===t)throw Error("Corrupted zip : compression "+r(this.compressionMethod)+" unknown (inner file : "+this.fileName+")")
if(this.uncompressedFileData=t.uncompress(this.compressedFileData),this.loadOptions.checkCRC32&&JSZip.prototype.crc32(this.uncompressedFileData)!==this.crc32)throw Error("Corrupted zip : CRC32 mismatch")
this.useUTF8()&&(this.fileName=JSZip.prototype.utf8decode(this.fileName))},findDataUntilDataDescriptor:function(e){for(var t,i="",r=e.readString(4);r!==JSZip.signature.DATA_DESCRIPTOR;)t=e.readString(1),i+=r.slice(0,1),r=(r+t).slice(-4)
return i},readCentralPart:function(e){this.versionMadeBy=e.readString(2),this.readLocalPartHeader(e),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.fileName=e.readString(this.fileNameLength),this.readExtraFields(e),this.fileComment=e.readString(this.fileCommentLength),this.useUTF8()&&(this.fileName=JSZip.prototype.utf8decode(this.fileName),this.fileComment=JSZip.prototype.utf8decode(this.fileComment)),this.dir=16&this.externalFileAttributes?!0:!1},parseZIP64ExtraField:function(){var t=new e(this.extraFields[1].value);-1===this.uncompressedSize&&(this.uncompressedSize=t.readInt(8)),-1===this.compressedSize&&(this.compressedSize=t.readInt(8)),-1===this.localHeaderOffset&&(this.localHeaderOffset=t.readInt(8)),-1===this.diskNumberStart&&(this.diskNumberStart=t.readInt(4))},readExtraFields:function(e){var t,i,r,s=e.index
for(this.extraFields=this.extraFields||{};e.index<s+this.extraFieldsLength;)t=e.readInt(2),i=e.readInt(2),r=e.readString(i),this.extraFields[t]={id:t,length:i,value:r}
this.isZIP64()&&this.extraFields[1]&&this.parseZIP64ExtraField(e)}},i.prototype={checkSignature:function(e){var t=this.reader.readString(4)
if(t!==e)throw Error("Corrupted zip or bug : unexpected signature ("+r(t)+", expected "+r(e)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={}
for(var e,t,i,r=this.zip64EndOfCentralSize-44,s=0;r>s;)e=this.reader.readInt(2),t=this.reader.readInt(4),i=this.reader.readString(t),this.zip64ExtensibleData[e]={id:e,length:t,value:i}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t
for(e=0;this.files.length>e;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(JSZip.signature.LOCAL_FILE_HEADER),t.readLocalPart(this.reader)},readCentralDir:function(){var e
for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===JSZip.signature.CENTRAL_FILE_HEADER;)e=new t({zip64:this.zip64},this.loadOptions),e.readCentralPart(this.reader),this.files.push(e)},readEndOfCentral:function(){var e=this.reader.stream.lastIndexOf(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR)
if(-1===e){if(this.zip64=!1,e=this.reader.stream.lastIndexOf(JSZip.signature.CENTRAL_DIRECTORY_END),-1===e)throw Error("Corrupted zip : can't find end of central directory")
this.reader.setIndex(e),this.checkSignature(JSZip.signature.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral()}else this.zip64=!0,this.reader.setIndex(e),this.checkSignature(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()},load:function(t){this.reader=new e(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},JSZip.prototype.load=function(e,t){var r,s,a,n
t=t||{},t.base64&&(e=JSZipBase64.decode(e)),s=new i(e,t),r=s.files
for(a in r)n=r[a],this.file(n.fileName,n.uncompressedFileData,{binary:!0,date:n.date,dir:n.dir})
return this}})();

/*
Port of a script by Masanao Izumo.

Only changes : wrap all the variables in a function and add the 
main function to JSZip (DEFLATE compression method).
Everything else was written by M. Izumo.

Original code can be found here: http://www.onicos.com/staff/iz/amuse/javascript/expert/deflate.txt
*/

if(!JSZip)throw"JSZip not defined";(function(){var r=32768,n=0,e=1,f=2,o=6,t=!0,i=32768,a=64,l=8192,c=2*r,u=3,s=258,d=16,_=8192,h=13
_>i&&alert("error: zip_INBUFSIZ is too small"),r<<1>1<<d&&alert("error: zip_WSIZE is too large"),h>d-1&&alert("error: zip_HASH_BITS is too large"),(8>h||258!=s)&&alert("error: Code too clever")
var v,x,m,y,w,A,p,g,b,S,I,E,Z,z,J,C,F,T,D,L,j,k,B,H,N,U,W,q,G,K,M,O,P,Q,R,V,X,Y,$,rn,nn,en,fn,on,tn,an,ln,cn,un,sn,dn,_n,hn,vn,xn,mn,yn=_,wn=1<<h,An=wn-1,pn=r-1,gn=0,bn=4096,Sn=s+u+1,In=r-Sn,En=1,Zn=15,zn=7,Jn=29,Cn=256,Fn=256,Tn=Cn+1+Jn,Dn=30,Ln=19,jn=16,kn=17,Bn=18,Hn=2*Tn+1,Nn=parseInt((h+u-1)/u),Un=null,Wn=function(){this.fc=0,this.dl=0},qn=function(){this.dyn_tree=null,this.static_tree=null,this.extra_bits=null,this.extra_base=0,this.elems=0,this.max_length=0,this.max_code=0},Gn=function(r,n,e,f){this.good_length=r,this.max_lazy=n,this.nice_length=e,this.max_chain=f},Kn=function(){this.next=null,this.len=0,this.ptr=Array(l),this.off=0},Mn=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],On=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Pn=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Qn=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Rn=[new Gn(0,0,0,0),new Gn(4,4,8,4),new Gn(4,5,16,8),new Gn(4,6,32,32),new Gn(4,4,16,16),new Gn(8,16,32,32),new Gn(8,16,128,128),new Gn(8,32,128,256),new Gn(32,128,258,1024),new Gn(32,258,258,4096)],Vn=function(r){var n
if(r?1>r?r=1:r>9&&(r=9):r=o,W=r,y=!1,B=!1,null==Un){for(v=x=m=null,Un=Array(l),g=Array(c),b=Array(yn),S=Array(i+a),I=Array(1<<d),K=Array(Hn),n=0;Hn>n;n++)K[n]=new Wn
for(M=Array(2*Dn+1),n=0;2*Dn+1>n;n++)M[n]=new Wn
for(O=Array(Tn+2),n=0;Tn+2>n;n++)O[n]=new Wn
for(P=Array(Dn),n=0;Dn>n;n++)P[n]=new Wn
for(Q=Array(2*Ln+1),n=0;2*Ln+1>n;n++)Q[n]=new Wn
R=new qn,V=new qn,X=new qn,Y=Array(Zn+1),$=Array(2*Tn+1),en=Array(2*Tn+1),fn=Array(s-u+1),on=Array(512),tn=Array(Jn),an=Array(Dn),ln=Array(parseInt(_/8))}},Xn=function(r){r.next=v,v=r},Yn=function(){var r
return null!=v?(r=v,v=v.next):r=new Kn,r.next=null,r.len=r.off=0,r},$n=function(n){return I[r+n]},re=function(n,e){return I[r+n]=e},ne=function(r){Un[A+w++]=r,A+w==l&&De()},ee=function(r){r&=65535,l-2>A+w?(Un[A+w++]=255&r,Un[A+w++]=r>>>8):(ne(255&r),ne(r>>>8))},fe=function(){J=(J<<Nn^255&g[j+u-1])&An,C=$n(J),I[j&pn]=C,re(J,j)},oe=function(r,n){Ce(n[r].fc,n[r].dl)},te=function(r){return 255&(256>r?on[r]:on[256+(r>>7)])},ie=function(r,n,e){return r[n].fc<r[e].fc||r[n].fc==r[e].fc&&en[n]<=en[e]},ae=function(r,n,e){var f
for(f=0;e>f&&xn.length>mn;f++)r[n+f]=255&xn.charCodeAt(mn++)
return f},le=function(){var n
for(n=0;wn>n;n++)I[r+n]=0
if(U=Rn[W].max_lazy,q=Rn[W].good_length,t||(G=Rn[W].nice_length),N=Rn[W].max_chain,j=0,z=0,H=ae(g,0,2*r),0>=H)return B=!0,H=0,void 0
for(B=!1;Sn>H&&!B;)ue()
for(J=0,n=0;u-1>n;n++)J=(J<<Nn^255&g[n])&An},ce=function(r){var n,e,f=N,o=j,i=L,a=j>In?j-In:gn,l=j+s,c=g[o+i-1],u=g[o+i]
L>=q&&(f>>=2)
do if(n=r,g[n+i]==u&&g[n+i-1]==c&&g[n]==g[o]&&g[++n]==g[o+1]){o+=2,n++
do;while(g[++o]==g[++n]&&g[++o]==g[++n]&&g[++o]==g[++n]&&g[++o]==g[++n]&&g[++o]==g[++n]&&g[++o]==g[++n]&&g[++o]==g[++n]&&g[++o]==g[++n]&&l>o)
if(e=s-(l-o),o=l-s,e>i){if(k=r,i=e,t){if(e>=s)break}else if(e>=G)break
c=g[o+i-1],u=g[o+i]}}while((r=I[r&pn])>a&&0!=--f)
return i},ue=function(){var n,e,f=c-H-j
if(-1==f)f--
else if(j>=r+In){for(n=0;r>n;n++)g[n]=g[n+r]
for(k-=r,j-=r,z-=r,n=0;wn>n;n++)e=$n(n),re(n,e>=r?e-r:gn)
for(n=0;r>n;n++)e=I[n],I[n]=e>=r?e-r:gn
f+=r}B||(n=ae(g,j+H,f),0>=n?B=!0:H+=n)},se=function(){for(;0!=H&&null==x;){var r
if(fe(),C!=gn&&In>=j-C&&(D=ce(C),D>H&&(D=H)),D>=u)if(r=Ze(j-k,D-u),H-=D,U>=D){D--
do j++,fe()
while(0!=--D)
j++}else j+=D,D=0,J=255&g[j],J=(J<<Nn^255&g[j+1])&An
else r=Ze(0,255&g[j]),H--,j++
for(r&&(Ee(0),z=j);Sn>H&&!B;)ue()}},de=function(){for(;0!=H&&null==x;){if(fe(),L=D,F=k,D=u-1,C!=gn&&U>L&&In>=j-C&&(D=ce(C),D>H&&(D=H),D==u&&j-k>bn&&D--),L>=u&&L>=D){var r
r=Ze(j-1-F,L-u),H-=L-1,L-=2
do j++,fe()
while(0!=--L)
T=0,D=u-1,j++,r&&(Ee(0),z=j)}else 0!=T?(Ze(0,255&g[j-1])&&(Ee(0),z=j),j++,H--):(T=1,j++,H--)
for(;Sn>H&&!B;)ue()}},_e=function(){B||(E=0,Z=0,xe(),le(),x=null,w=0,A=0,3>=W?(L=u-1,D=0):(D=u-1,T=0),p=!1)},he=function(r,n,e){var f
return y||(_e(),y=!0,0!=H)?(f=ve(r,n,e))==e?e:p?f:(3>=W?se():de(),0==H&&(0!=T&&Ze(0,255&g[j-1]),Ee(1),p=!0),f+ve(r,f+n,e-f)):(p=!0,0)},ve=function(r,n,e){var f,o,t
for(f=0;null!=x&&e>f;){for(o=e-f,o>x.len&&(o=x.len),t=0;o>t;t++)r[n+f+t]=x.ptr[x.off+t]
if(x.off+=o,x.len-=o,f+=o,0==x.len){var i
i=x,x=x.next,Xn(i)}}if(f==e)return f
if(w>A){for(o=e-f,o>w-A&&(o=w-A),t=0;o>t;t++)r[n+f+t]=Un[A+t]
A+=o,f+=o,w==A&&(w=A=0)}return f},xe=function(){var r,n,e,f,o
if(0==P[0].dl){for(R.dyn_tree=K,R.static_tree=O,R.extra_bits=Mn,R.extra_base=Cn+1,R.elems=Tn,R.max_length=Zn,R.max_code=0,V.dyn_tree=M,V.static_tree=P,V.extra_bits=On,V.extra_base=0,V.elems=Dn,V.max_length=Zn,V.max_code=0,X.dyn_tree=Q,X.static_tree=null,X.extra_bits=Pn,X.extra_base=0,X.elems=Ln,X.max_length=zn,X.max_code=0,e=0,f=0;Jn-1>f;f++)for(tn[f]=e,r=0;1<<Mn[f]>r;r++)fn[e++]=f
for(fn[e-1]=f,o=0,f=0;16>f;f++)for(an[f]=o,r=0;1<<On[f]>r;r++)on[o++]=f
for(o>>=7;Dn>f;f++)for(an[f]=o<<7,r=0;1<<On[f]-7>r;r++)on[256+o++]=f
for(n=0;Zn>=n;n++)Y[n]=0
for(r=0;143>=r;)O[r++].dl=8,Y[8]++
for(;255>=r;)O[r++].dl=9,Y[9]++
for(;279>=r;)O[r++].dl=7,Y[7]++
for(;287>=r;)O[r++].dl=8,Y[8]++
for(Ae(O,Tn+1),r=0;Dn>r;r++)P[r].dl=5,P[r].fc=Fe(r,5)
me()}},me=function(){var r
for(r=0;Tn>r;r++)K[r].fc=0
for(r=0;Dn>r;r++)M[r].fc=0
for(r=0;Ln>r;r++)Q[r].fc=0
K[Fn].fc=1,hn=vn=0,cn=un=sn=0,dn=0,_n=1},ye=function(r,n){for(var e=$[n],f=n<<1;rn>=f&&(rn>f&&ie(r,$[f+1],$[f])&&f++,!ie(r,e,$[f]));)$[n]=$[f],n=f,f<<=1
$[n]=e},we=function(r){var n,e,f,o,t,i,a=r.dyn_tree,l=r.extra_bits,c=r.extra_base,u=r.max_code,s=r.max_length,d=r.static_tree,_=0
for(o=0;Zn>=o;o++)Y[o]=0
for(a[$[nn]].dl=0,n=nn+1;Hn>n;n++)e=$[n],o=a[a[e].dl].dl+1,o>s&&(o=s,_++),a[e].dl=o,e>u||(Y[o]++,t=0,e>=c&&(t=l[e-c]),i=a[e].fc,hn+=i*(o+t),null!=d&&(vn+=i*(d[e].dl+t)))
if(0!=_){do{for(o=s-1;0==Y[o];)o--
Y[o]--,Y[o+1]+=2,Y[s]--,_-=2}while(_>0)
for(o=s;0!=o;o--)for(e=Y[o];0!=e;)f=$[--n],f>u||(a[f].dl!=o&&(hn+=(o-a[f].dl)*a[f].fc,a[f].fc=o),e--)}},Ae=function(r,n){var e,f,o=Array(Zn+1),t=0
for(e=1;Zn>=e;e++)t=t+Y[e-1]<<1,o[e]=t
for(f=0;n>=f;f++){var i=r[f].dl
0!=i&&(r[f].fc=Fe(o[i]++,i))}},pe=function(r){var n,e,f=r.dyn_tree,o=r.static_tree,t=r.elems,i=-1,a=t
for(rn=0,nn=Hn,n=0;t>n;n++)0!=f[n].fc?($[++rn]=i=n,en[n]=0):f[n].dl=0
for(;2>rn;){var l=$[++rn]=2>i?++i:0
f[l].fc=1,en[l]=0,hn--,null!=o&&(vn-=o[l].dl)}for(r.max_code=i,n=rn>>1;n>=1;n--)ye(f,n)
do n=$[En],$[En]=$[rn--],ye(f,En),e=$[En],$[--nn]=n,$[--nn]=e,f[a].fc=f[n].fc+f[e].fc,en[a]=en[n]>en[e]+1?en[n]:en[e]+1,f[n].dl=f[e].dl=a,$[En]=a++,ye(f,En)
while(rn>=2)
$[--nn]=$[En],we(r),Ae(f,i)},ge=function(r,n){var e,f,o=-1,t=r[0].dl,i=0,a=7,l=4
for(0==t&&(a=138,l=3),r[n+1].dl=65535,e=0;n>=e;e++)f=t,t=r[e+1].dl,a>++i&&f==t||(l>i?Q[f].fc+=i:0!=f?(f!=o&&Q[f].fc++,Q[jn].fc++):10>=i?Q[kn].fc++:Q[Bn].fc++,i=0,o=f,0==t?(a=138,l=3):f==t?(a=6,l=3):(a=7,l=4))},be=function(r,n){var e,f,o=-1,t=r[0].dl,i=0,a=7,l=4
for(0==t&&(a=138,l=3),e=0;n>=e;e++)if(f=t,t=r[e+1].dl,!(a>++i&&f==t)){if(l>i){do oe(f,Q)
while(0!=--i)}else 0!=f?(f!=o&&(oe(f,Q),i--),oe(jn,Q),Ce(i-3,2)):10>=i?(oe(kn,Q),Ce(i-3,3)):(oe(Bn,Q),Ce(i-11,7))
i=0,o=f,0==t?(a=138,l=3):f==t?(a=6,l=3):(a=7,l=4)}},Se=function(){var r
for(ge(K,R.max_code),ge(M,V.max_code),pe(X),r=Ln-1;r>=3&&0==Q[Qn[r]].dl;r--);return hn+=3*(r+1)+5+5+4,r},Ie=function(r,n,e){var f
for(Ce(r-257,5),Ce(n-1,5),Ce(e-4,4),f=0;e>f;f++)Ce(Q[Qn[f]].dl,3)
be(K,r-1),be(M,n-1)},Ee=function(r){var o,t,i,a
if(a=j-z,ln[sn]=dn,pe(R),pe(V),i=Se(),o=hn+3+7>>3,t=vn+3+7>>3,o>=t&&(o=t),o>=a+4&&z>=0){var l
for(Ce((n<<1)+r,3),Te(),ee(a),ee(~a),l=0;a>l;l++)ne(g[z+l])}else t==o?(Ce((e<<1)+r,3),ze(O,P)):(Ce((f<<1)+r,3),Ie(R.max_code+1,V.max_code+1,i+1),ze(K,M))
me(),0!=r&&Te()},Ze=function(r,n){if(S[cn++]=n,0==r?K[n].fc++:(r--,K[fn[n]+Cn+1].fc++,M[te(r)].fc++,b[un++]=r,dn|=_n),_n<<=1,0==(7&cn)&&(ln[sn++]=dn,dn=0,_n=1),W>2&&0==(4095&cn)){var e,f=8*cn,o=j-z
for(e=0;Dn>e;e++)f+=M[e].fc*(5+On[e])
if(f>>=3,parseInt(cn/2)>un&&parseInt(o/2)>f)return!0}return cn==_-1||un==yn},ze=function(r,n){var e,f,o,t,i=0,a=0,l=0,c=0
if(0!=cn)do 0==(7&i)&&(c=ln[l++]),f=255&S[i++],0==(1&c)?oe(f,r):(o=fn[f],oe(o+Cn+1,r),t=Mn[o],0!=t&&(f-=tn[o],Ce(f,t)),e=b[a++],o=te(e),oe(o,n),t=On[o],0!=t&&(e-=an[o],Ce(e,t))),c>>=1
while(cn>i)
oe(Fn,r)},Je=16,Ce=function(r,n){Z>Je-n?(E|=r<<Z,ee(E),E=r>>Je-Z,Z+=n-Je):(E|=r<<Z,Z+=n)},Fe=function(r,n){var e=0
do e|=1&r,r>>=1,e<<=1
while(--n>0)
return e>>1},Te=function(){Z>8?ee(E):Z>0&&ne(E),E=0,Z=0},De=function(){if(0!=w){var r,n
for(r=Yn(),null==x?x=m=r:m=m.next=r,r.len=w-A,n=0;r.len>n;n++)r.ptr[n]=Un[A+n]
w=A=0}},Le=function(r,n){var e,f
xn=r,mn=0,n===void 0&&(n=o),Vn(n)
for(var t=Array(1024),i=[];(e=he(t,0,t.length))>0;){var a=Array(e)
for(f=0;e>f;f++)a[f]=String.fromCharCode(t[f])
i[i.length]=a.join("")}return xn=null,i.join("")}
JSZip.compressions.DEFLATE?JSZip.compressions.DEFLATE.compress=Le:JSZip.compressions.DEFLATE={magic:"\b\0",compress:Le}})();

/*
 * Port of a script by Masanao Izumo.
 *
 * Only changes : wrap all the variables in a function and add the 
 * main function to JSZip (DEFLATE compression method).
 * Everything else was written by M. Izumo.
 *
 * Original code can be found here: http://www.onicos.com/staff/iz/amuse/javascript/expert/inflate.txt
 */

if(!JSZip)throw"JSZip not defined";(function(){function r(){this.next=null,this.list=null}function t(){this.e=0,this.b=0,this.n=0,this.t=null}function n(n,i,e,o,f,s){this.BMAX=16,this.N_MAX=288,this.status=0,this.root=null,this.m=0
var u,l,a,h,c,A,b,m,w,d,v,g,p,y,B,M,X,E=Array(this.BMAX+1),S=Array(this.BMAX+1),k=new t,J=Array(this.BMAX),Z=Array(this.N_MAX),x=Array(this.BMAX+1)
for(X=this.root=null,A=0;E.length>A;A++)E[A]=0
for(A=0;S.length>A;A++)S[A]=0
for(A=0;J.length>A;A++)J[A]=null
for(A=0;Z.length>A;A++)Z[A]=0
for(A=0;x.length>A;A++)x[A]=0
l=i>256?n[256]:this.BMAX,w=n,d=0,A=i
do E[w[d]]++,d++
while(--A>0)
if(E[0]==i)return this.root=null,this.m=0,this.status=0,void 0
for(b=1;this.BMAX>=b&&0==E[b];b++);for(m=b,b>s&&(s=b),A=this.BMAX;0!=A&&0==E[A];A--);for(h=A,s>A&&(s=A),y=1<<b;A>b;b++,y<<=1)if(0>(y-=E[b]))return this.status=2,this.m=s,void 0
if(0>(y-=E[A]))return this.status=2,this.m=s,void 0
for(E[A]+=y,x[1]=b=0,w=E,d=1,p=2;--A>0;)x[p++]=b+=w[d++]
w=n,d=0,A=0
do 0!=(b=w[d++])&&(Z[x[b]++]=A)
while(i>++A)
for(i=x[h],x[0]=A=0,w=Z,d=0,c=-1,g=S[0]=0,v=null,B=0;h>=m;m++)for(u=E[m];u-->0;){for(;m>g+S[1+c];){if(g+=S[1+c],c++,B=(B=h-g)>s?s:B,(a=1<<(b=m-g))>u+1)for(a-=u+1,p=m;B>++b&&!((a<<=1)<=E[++p]);)a-=E[p]
for(g+b>l&&l>g&&(b=l-g),B=1<<b,S[1+c]=b,v=Array(B),M=0;B>M;M++)v[M]=new t
X=null==X?this.root=new r:X.next=new r,X.next=null,X.list=v,J[c]=v,c>0&&(x[c]=A,k.b=S[c],k.e=16+b,k.t=v,b=(A&(1<<g)-1)>>g-S[c],J[c-1][b].e=k.e,J[c-1][b].b=k.b,J[c-1][b].n=k.n,J[c-1][b].t=k.t)}for(k.b=m-g,d>=i?k.e=99:e>w[d]?(k.e=256>w[d]?16:15,k.n=w[d++]):(k.e=f[w[d]-e],k.n=o[w[d++]-e]),a=1<<m-g,b=A>>g;B>b;b+=a)v[b].e=k.e,v[b].b=k.b,v[b].n=k.n,v[b].t=k.t
for(b=1<<m-1;0!=(A&b);b>>=1)A^=b
for(A^=b;(A&(1<<g)-1)!=x[c];)g-=S[c],c--}this.m=S[1],this.status=0!=y&&1!=h?1:0}function i(){return Z.length==x?-1:255&Z.charCodeAt(x++)}function e(r){for(;r>p;)g|=i()<<p,p+=8}function o(r){return g&H[r]}function f(r){g>>=r,p-=r}function s(r,t,n){var i,s,u
if(0==n)return 0
for(u=0;;){for(e(k),s=E.list[o(k)],i=s.e;i>16;){if(99==i)return-1
f(s.b),i-=16,e(i),s=s.t[o(i)],i=s.e}if(f(s.b),16!=i){if(15==i)break
for(e(i),M=s.n+o(i),f(i),e(J),s=S.list[o(J)],i=s.e;i>16;){if(99==i)return-1
f(s.b),i-=16,e(i),s=s.t[o(i)],i=s.e}for(f(s.b),e(i),X=w-s.n-o(i),f(i);M>0&&n>u;)M--,X&=C-1,w&=C-1,r[t+u++]=m[w++]=m[X++]
if(u==n)return n}else if(w&=C-1,r[t+u++]=m[w++]=s.n,u==n)return n}return y=-1,u}function u(r,t,n){var i
if(i=7&p,f(i),e(16),i=o(16),f(16),e(16),i!=(65535&~g))return-1
for(f(16),M=i,i=0;M>0&&n>i;)M--,w&=C-1,e(8),r[t+i++]=m[w++]=o(8),f(8)
return 0==M&&(y=-1),i}function l(r,t,i){if(null==T){var e,o,f=Array(288)
for(e=0;144>e;e++)f[e]=8
for(;256>e;e++)f[e]=9
for(;280>e;e++)f[e]=7
for(;288>e;e++)f[e]=8
if(v=7,o=new n(f,288,257,N,_,v),0!=o.status)return alert("HufBuild error: "+o.status),-1
for(T=o.root,v=o.m,e=0;30>e;e++)f[e]=5
if(b=5,o=new n(f,30,0,j,q,b),o.status>1)return T=null,alert("HufBuild error: "+o.status),-1
d=o.root,b=o.m}return E=T,S=d,k=v,J=b,s(r,t,i)}function a(r,t,i){var u,l,a,h,c,A,b,m,w,d=Array(316)
for(u=0;d.length>u;u++)d[u]=0
if(e(5),b=257+o(5),f(5),e(5),m=1+o(5),f(5),e(4),A=4+o(4),f(4),b>286||m>30)return-1
for(l=0;A>l;l++)e(3),d[z[l]]=o(3),f(3)
for(;19>l;l++)d[z[l]]=0
if(k=7,w=new n(d,19,19,null,null,k),0!=w.status)return-1
for(E=w.root,k=w.m,h=b+m,u=a=0;h>u;)if(e(k),c=E.list[o(k)],l=c.b,f(l),l=c.n,16>l)d[u++]=a=l
else if(16==l){if(e(2),l=3+o(2),f(2),u+l>h)return-1
for(;l-->0;)d[u++]=a}else if(17==l){if(e(3),l=3+o(3),f(3),u+l>h)return-1
for(;l-->0;)d[u++]=0
a=0}else{if(e(7),l=11+o(7),f(7),u+l>h)return-1
for(;l-->0;)d[u++]=0
a=0}if(k=F,w=new n(d,b,257,N,_,k),0==k&&(w.status=1),0!=w.status)return 1==w.status,-1
for(E=w.root,k=w.m,u=0;m>u;u++)d[u]=d[u+b]
return J=L,w=new n(d,m,0,j,q,J),S=w.root,J=w.m,0==J&&b>257?-1:(1==w.status,0!=w.status?-1:s(r,t,i))}function h(){null==m&&(m=Array(2*C)),w=0,g=0,p=0,y=-1,B=!1,M=X=0,E=null}function c(r,t,n){var i,h
for(i=0;n>i;){if(B&&-1==y)return i
if(M>0){if(y!=D)for(;M>0&&n>i;)M--,X&=C-1,w&=C-1,r[t+i++]=m[w++]=m[X++]
else{for(;M>0&&n>i;)M--,w&=C-1,e(8),r[t+i++]=m[w++]=o(8),f(8)
0==M&&(y=-1)}if(i==n)return i}if(-1==y){if(B)break
e(1),0!=o(1)&&(B=!0),f(1),e(2),y=o(2),f(2),E=null,M=0}switch(y){case 0:h=u(r,t+i,n-i)
break
case 1:h=null!=E?s(r,t+i,n-i):l(r,t+i,n-i)
break
case 2:h=null!=E?s(r,t+i,n-i):a(r,t+i,n-i)
break
default:h=-1}if(-1==h)return B?0:-1
i+=h}return i}function A(r){var t,n,i,e
for(h(),Z=r,x=0,n=Array(1024),t="";(i=c(n,0,n.length))>0;)for(e=0;i>e;e++)t+=String.fromCharCode(n[e])
return Z=null,t}var b,m,w,d,v,g,p,y,B,M,X,E,S,k,J,Z,x,C=32768,D=0,F=9,L=6,T=null,H=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],N=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],_=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],j=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],q=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]
JSZip.compressions.DEFLATE?JSZip.compressions.DEFLATE.uncompress=A:JSZip.compressions.DEFLATE={magic:"\b\0",uncompress:A}})();
